rule zxshell_rootkit
{
	meta:
		copyright = "Novetta Solutions"
		author = "Novetta Advanced Research Group"

	strings:
		$s1 = "the end!!" fullword
		$tcpstr0 = "TCPFilter_Attach Successfully."
		$tcpstr1 = "TCPFilter_Attach: TCPFilter_Detach Finished" fullword
		$tcpstr2 = "TCPFilter_Attach: Couldn't attach to TCP Device Object"
		$output1 = "filetype[NTFS] process:[%s] is scaning file[%ws][%ws]"
		$output2 = "file protect:%ws"

	condition:
		all of ($tcpstr*) and ($s1 or $output1 or $output2)
}

rule zxshell_variant1
{
	meta:
		copyright = "Novetta Solutions"
		author = "Novetta Advanced Research Group"


	strings:
		$prefix1 = "[RDT] " ascii
		$prefix2 = "[DeskTop] " ascii
		$s1 = "IsThatMyMaster Error" ascii
		$s2 = "exec cmd failed :(" ascii
		$bs1 = {ff 15 70 50 00 10}
		condition:
			(#prefix1 > 3 or #prefix2 > 1) and (all of ($s*) or #bs1 > 1)
}

rule zxshell_shareshell_module
{
	meta:
		copyright = "Novetta Solutions"
		author = "Novetta Advanced Research Group"

	strings:
		$cmd = "ShareShell"
		$s1 = "Shared a shell to %s:%s Successfully."
		$s2 = "ShareShell 1.1.1.1 99"
	condition:
		#cmd > 1 and all of ($s*) 
} 

rule zxshell_vfw
{
	meta:
		copyright = "Novetta Solutions"
		author = "Novetta Advanced Research Group"

	strings:
		$mz = { 4d 5a }
		$plug = "zxplug" ascii
		$prefix1 = "[DeskTop]" ascii
		$prefix2 = "[RDT]" ascii
		$shsl = "ShareShell" ascii

	condition:
		( $mz at 0 ) and ((#plug > 2 and #shsl > 1) or (#prefix1 > 3) or (#prefix2 > 3)) 
}

rule zxshell_pluginmanager
{
	meta:
		copyright = "Novetta Solutions"
		author = "Novetta Advanced Research Group"

	strings:
		$a1 ="%d plug-ins you add the command" fullword
		$a2 = "Error, the plugin is not loaded." fullword
		$a3 = "Plug-in added successfully. %s" fullword
		$b1 = "not export zxMain func."
		$b2 = "cmd name exist, please use other."
		$b3 = "SYSTEM\\CurrentControlSet\\Control\\zxplug"
		$cmd = "zxplug"

	condition:
		#cmd > 3 and (all of ($a*) or all of ($b*))
} 

rule zxshell_transferfile_module
{
	meta:
		copyright = "Novetta Solutions"
		author = "Novetta Advanced Research Group"

	strings:
		$cmd = "TransFile"
		$s1 = "put IP port user pass localfile remotefile"
		$s2 = "get URL SaveAs"
		$s3 = "Transfer successful: %d bytes in %d millisecond."
	condition:
		#cmd > 3 and all of ($s*) 
}

rule zxshell_http_proxy_module
{
	meta:
		copyright = "Novetta Solutions"
		author = "Novetta Advanced Research Group"

	strings:
		$s1 = "ZxHttpProxy" nocase
		$s2 = "(All IP Is Acceptable.)"
		$s3 = "(End Proxy Service.)"
		$s4 = "(View Server Info)"

	condition:
		#s1 > 1 and all of ($s*)

}

rule zxshell_portscan_module
{
	meta:
		copyright = "Novetta Solutions"
		author = "Novetta Advanced Research Group"

	strings:
		$s1 = "================Start Scaning================" 
		$s2 = "================End================" 
		$s3 = "TCP Port MultiScanner"

	condition:
		all of them

}

rule zxshell_zxnc_module
{
	meta:
		copyright = "Novetta Solutions"
		author = "Novetta Advanced Research Group"

	strings:
		$s1 = "ZXNC"
		$s2 = "listen mode, for inbound connects"
		$s3 = "(while in the ZXNC mode type this option to quit it.)"

	condition:
		all of them

}

